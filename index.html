<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>
<body>
  <div class="container">
    <div class="panel-group" id="accordion">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseUsers">Select Users</a>
          </h4>
      </div>
      <div id="collapseUsers" class="panel-collapse collapse">
        <div class="panel-body">
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="0" checked>
                  Maccas
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="1">
                  Mr. Mean
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="2">
                  Mr. Median
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="3">
                  Binary Boy
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="4">
                  DTM
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="5">
                  Will Mac
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="6">
                  Kov
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="7">
                  Sammie
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="8">
                  The Councillor 
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="9">
                  Clare Mac
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="10">
                  Tom Mac
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="11">
                  Fi Mac
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="12">
                  Matt
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="13">
                  G.Mozz
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="14">
                  Haller
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="15">
                  Ben
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="16">
                  Ollie
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="17">
                  Mr. Mode
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="18">
                  David
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="19">
                  Coups
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="20">
                  Peck
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="21">
                  Gen
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="22">
                  Ross
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="23">
                  Mark S
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="24" >
                  Mond
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="25">
                  Lottie
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="26">
                  Lady Peck
                </label>
              </div>
            </div>
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="27">
                  galsnakes
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-6 col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" value="28">
                  Jonny
                </label>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>
    </div>
    <div id="graph"></div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
  
  // Load the Visualization API and the piechart package.
  google.load('visualization', '1.0', {'packages':['corechart']});
  
  // Variables to hold the data for the three charts
  var dataPoints;
  var maxScale;
  
  // Set a callback to run when the Google Visualization API is loaded.
  google.setOnLoadCallback(function (){
    
    // Load the data - only need do this once
    var tmp = initDataPoints();
    dataPoints = tmp.data;
    maxScale = tmp.maxScale;
    
    // Draw the charts
    drawChart(dataPoints, maxScale);
  });
  
  // Add click handler to all user checkboxes
  $(document).ready(function() {
    $('#collapseUsers').find('[type=checkbox]').click(function(e) {
      drawChart(dataPoints);
    });
  });
  
  // Create trigger to resizeEnd event
  $(window).resize(function() {
    if(this.resizeTo) clearTimeout(this.resizeTo);
    this.resizeTo = setTimeout(function() {
      $(this).trigger('resizeEnd');
    }, 500);
  });
  
  // Redraw graph when window resize is completed
  $(window).on('resizeEnd', function() {
    drawChart(dataPoints, maxScale);
  });
  
  // A function to initialise the points data
  function initDataPoints() {
  
    var data = new google.visualization.DataTable();
    
    var predictions = [
      {name: 'Maccas', home: 30, away: 13},
      {name: 'Mr. Mean', home: 32, away: 12},
      {name: 'Mr. Median', home: 34, away: 12},
      {name: 'Binary Boy', home: 40, away: 13},
      {name: 'DTM', home: 37, away: 13},
      {name: 'Will Mac', home: 27, away: 13},
      {name: 'Kov', home: 45, away: 12},
      {name: 'Sammie', home: 40, away: 18},
      {name: 'The Councillor', home: 35, away: 15},
      {name: 'Clare Mac', home: 23, away: 15},
      {name: 'Tom Mac', home: 31, away: 12},
      {name: 'Fi Mac', home: 23, away: 7},
      {name: 'Matt', home: 32, away: 12},
      {name: 'G.Mozz', home: 24, away: 8},
      {name: 'Haller', home: 35, away: 10},
      {name: 'Ben', home: 28, away: 13},
      {name: 'Ollie', home: 35, away: 10},
      {name: 'Mr. Mode', home: 33, away: 13},
      {name: 'David', home: 27, away: 10},
      {name: 'Coups', home: 38, away: 13},
      {name: 'Peck', home: 42, away: 10},
      {name: 'Gen', home: 8, away: 3},
      {name: 'Ross', home: 18, away: 8},
      {name: 'Mark S', home: 36, away: 13},
      {name: 'Mond', home: 30, away: 9},
      {name: 'Lottie', home: 30, away: 10},
      {name: 'Lady Peck', home: 37, away: 14},
      {name: 'galsnakes', home: 44, away: 12},
      {name: 'Jonny', home: 36, away: 70}
    ];
    
    var result = { home: 35, away: 11 };
    
    var l = predictions.length;
    
    // Add columns
    data.addColumn('number');
    for (var i = 0; i < l; i++) {
      data.addColumn('number', predictions[i].name);
    }    
    data.addColumn('number', 'Result');
    data.addColumn('number', 'Win Line');
    data.addColumn({ type:'string', role:'tooltip' });
    
    // Add data
    var maxScore = 0;
    for (var i = 0; i < l; i++) {
      data.addRow();
      data.setCell(i, 0, predictions[i].home);
      data.setCell(i, i + 1, predictions[i].away);
      data.setCell(i, l + 3, predictions[i].name);
      maxScore = (predictions[i].home > maxScore) ? predictions[i].home : maxScore;
      maxScore = (predictions[i].away > maxScore) ? predictions[i].away : maxScore;
    }
    
    // Add result to max score
    maxScore = (result.home > maxScore) ? result.home : maxScore;
    maxScore = (result.away > maxScore) ? result.away : maxScore;
    
    maxScore = (Math.floor((maxScore - 1) / 5) + 1) * 5;
    
    // Add result
    data.addRow();
    data.setCell(l, 0, result.home);
    data.setCell(l, l + 1, result.away);
    data.setCell(l, l + 3, 'Result');
    
    // Add win line
    data.addRow();
    data.setCell(l + 1, 0, 0);
    data.setCell(l + 1, l + 2, 0);
    data.setCell(l + 1, l + 3, '');
    data.addRow();
    data.setCell(l + 2, 0, maxScore);
    data.setCell(l + 2, l + 2, maxScore);
    data.setCell(l + 2, l + 3, '');

    return { data: data, maxScale: maxScore };
  }
  
  // Build up series array for
  function getSeries() {
    // get all elements in the form
    var series = [];
    var $ckb;
    var j;
    var max = 0;
    // loop through the elements
    // grab colour if checked or grey if not
    // make sure they're sorted right!
    $('#collapseUsers').find('[type=checkbox]').each(function (index) {
      $ckb = $(this);
      j = $ckb.attr('value') * 1;
      max = (j > max) ? j : max;
      if ($ckb.is(':checked')) {
        series[j] = { visibleInLegend: true, pointSize: 6 };
      } else {
        series[j] = { color: '#888', visibleInLegend: false, pointSize: 2 };
      }
    });
    // Add styling for win line and result
    series[max + 1] = { color: '#bd162d', visibleInLegend: true, pointSize: 20, pointShape: { type: 'star', sides: 4, rotation: 45, dent: 0.2 } };
    series[max + 2] = { color: '#dddddd', visibleInLegend: false, pointSize: 0, lineWidth: 2};
    return series;
  }
  
  // Callback that creates the options for the three charts and then draws them
  function drawChart(data, scale) {
    
    // Determine the dimensions
    var h = $(window).height();
    var w = $(window).width();
    // Max width
    w = Math.min(w, 700);
    // Padding
    h -= 90;
    w -= 30;
    // Keep 9 x 5 dimensions
    if (h > w) {
      h = w;
    } else {
      w = h;
    }
    
    // Set the options
    var lines = (scale / 5) + 1;
    var options = {
      height: h,
      width: w,
      lineWidth: 0,
      pointSize: 4,
      legend: { position: 'top' },
      hAxis: { title: 'England', textPosition: 'out', baselineColor: 'transparent', gridlines: { color: '#f4f4f4', count: lines }, maxValue: scale, minValue: 0 },
      vAxis: { title: 'Fiji', textPosition: 'out', baselineColor: 'transparent', gridlines: { color: '#f4f4f4', count: lines }, maxValue: scale, minValue: 0} ,
      crosshair: { trigger: 'both', orientation: 'both' },
      series: getSeries()
    };
    
    // Draw the chart
    var chart = new google.visualization.LineChart(document.getElementById('graph'));
    chart.draw(data, options);
  }
  
  </script>
</body>
</html>